<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèõÔ∏è Latin Study Bot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .main-content {
            padding: 30px;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        .menu-button {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 20px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            margin: 10px 0;
            width: 100%;
            transition: all 0.3s ease;
            text-align: left;
        }
        
        .menu-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .back-button {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(149, 165, 166, 0.4);
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .vocabulary-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }
        
        .quiz-container {
            display: none;
            text-align: center;
        }
        
        .quiz-question {
            font-size: 1.8em;
            margin: 20px 0;
            color: #2c3e50;
        }
        
        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .quiz-option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .quiz-option:hover {
            border-color: #3498db;
            transform: translateY(-2px);
        }
        
        .quiz-option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }
        
        .quiz-option.correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }
        
        .quiz-option.incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .vocabulary-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: white;
        }
        
        .vocab-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .vocab-item:last-child {
            border-bottom: none;
        }
        
        .vocab-latin {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .vocab-english {
            color: #7f8c8d;
        }
        
        .learned {
            background: #d5f4e6;
        }
        
        .hidden {
            display: none;
        }
        
        .login-form {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .form-buttons .btn {
            flex: 1;
        }
        
        #welcomeMessage {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        #welcomeMessage p {
            margin: 0;
            font-weight: bold;
            color: #27ae60;
        }
        
        .guest-section {
            margin-top: 30px;
            text-align: center;
        }
        
        .guest-button {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            border: none;
            padding: 25px 50px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.3);
        }
        
        .guest-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(155, 89, 182, 0.4);
        }
        
        .guest-description {
            color: #7f8c8d;
            font-size: 14px;
            margin: 10px 0;
        }
        
        .message {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message.success {
            background: #d5f4e6;
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        
        .message.error {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        .message.info {
            background: #e3f2fd;
            color: #3498db;
            border: 1px solid #3498db;
        }
        
        .message.warning {
            background: #fef9e7;
            color: #f39c12;
            border: 1px solid #f39c12;
        }
        
        .hint-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            color: #856404;
        }
        
        .feedback-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .feedback-correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }
        
        .feedback-incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            transition: width 0.3s ease;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
        }
        
        .nav-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .nav-btn-primary {
            background: #3498db;
            color: white;
        }
        
        .nav-btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .nav-btn-success {
            background: #27ae60;
            color: white;
        }
        
        .nav-btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                max-width: 100%;
                margin: 0;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .quiz-options {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .quiz-option {
                padding: 12px;
                font-size: 14px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-number {
                font-size: 1.5em;
            }
            
            .vocabulary-input {
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 14px;
                margin: 3px;
            }
            
            .menu-button {
                padding: 15px 20px;
                font-size: 16px;
            }
        }
        
        /* Ensure scrollbar is always visible on mobile */
        @media (max-width: 768px) {
            body {
                -webkit-overflow-scrolling: touch;
                overflow-y: scroll;
            }
            
            .container {
                min-height: 100vh;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è Latin Study Bot</h1>
            <p>Comprehensive Latin Learning with Grammar & Vocabulary</p>
        </div>
        
        <div class="main-content">
            <!-- Login Screen -->
            <div id="login" class="screen active">
                <div class="section">
                    <h2>üèõÔ∏è Latin Study Bot</h2>
                    <p>Please login or create an account</p>
                    
                    <div class="login-form">
                        <div class="form-group">
                            <label for="nicknameInput">Nickname (max 16 characters):</label>
                            <input type="text" id="nicknameInput" class="vocabulary-input" maxlength="16" placeholder="Enter your nickname">
                        </div>
                        
                        <div class="form-group">
                            <label for="pinInput">PIN (4-8 numbers):</label>
                            <input type="password" id="pinInput" class="vocabulary-input" maxlength="8" placeholder="Enter your PIN">
                        </div>
                        
                        <div class="form-buttons">
                            <button class="btn" onclick="login()">Login</button>
                            <button class="btn btn-success" onclick="register()">Register</button>
                        </div>
                        
                        <div class="guest-section">
                            <button class="guest-button" onclick="loginAsGuest()">
                                üë§ GUEST
                            </button>
                            <p class="guest-description">Use the app without creating an account</p>
                        </div>
                        
                        <div id="loginStatus" class="message hidden"></div>
                    </div>
                </div>
            </div>
            
            <!-- Main Menu Screen -->
            <div id="mainMenu" class="screen">
                <div class="section">
                    <h2>üèõÔ∏è Main Menu</h2>
                    <div id="welcomeMessage">
                        <p>Welcome back, <span id="userNickname"></span>!</p>
                        <button class="btn btn-danger" onclick="logout()">Logout</button>
                    </div>
                    
                    <button class="menu-button" onclick="showScreen('vocabulary')">
                        üìö Vocabulary Management
                        <br><small>Add, edit, and manage Latin vocabulary</small>
                    </button>
                    
                    <button class="menu-button" onclick="showScreen('quiz')">
                        üß† Take Quiz
                        <br><small>Test your Latin knowledge with interactive quizzes</small>
                    </button>
                    
                    <button class="menu-button" onclick="showScreen('progress')">
                        üìä View Progress
                        <br><small>Track your learning progress and statistics</small>
                    </button>
                    
                    <button class="menu-button" onclick="showScreen('settings')">
                        ‚öôÔ∏è Settings
                        <br><small>Manage data and application settings</small>
                    </button>
                </div>
            </div>
            
            <!-- Vocabulary Management Screen -->
            <div id="vocabulary" class="screen">
                <button class="back-button" onclick="showScreen('mainMenu')">‚Üê Back to Main Menu</button>
                
                <div class="section">
                    <h2>üìö Vocabulary Management</h2>
                    <div>
                        <input type="text" id="latinInput" class="vocabulary-input" placeholder="Latin word (e.g., sum)">
                        <input type="text" id="englishInput" class="vocabulary-input" placeholder="English meaning (e.g., to be)">
                        <input type="text" id="hintInput" class="vocabulary-input" placeholder="Hint (e.g., First conjugation verb)">
                        <button class="btn" onclick="addVocabulary()">Add Word</button>
                        <button class="btn btn-success" onclick="loadSampleData()">Load Sample Data</button>
                    </div>
                    <div id="vocabularyList" class="vocabulary-list"></div>
                </div>
            </div>
            
            <!-- Quiz Screen -->
            <div id="quiz" class="screen">
                <button class="back-button" onclick="showScreen('mainMenu')">‚Üê Back to Main Menu</button>
                
                <div class="section">
                    <h2>üß† Quiz Mode</h2>
                    <div id="quizSetup">
                        <div class="quiz-type-selector">
                            <button class="btn" onclick="startQuizWithType('vocabulary')" data-type="vocabulary">
                                üìñ Vocabulary
                            </button>
                            <button class="btn" onclick="startQuizWithType('grammar')" data-type="grammar">
                                üìù Grammar
                            </button>
                            <button class="btn" onclick="startQuizWithType('verb_forms')" data-type="verb_forms">
                                üî§ Verb Forms
                            </button>
                            <button class="btn" onclick="startQuizWithType('noun_forms')" data-type="noun_forms">
                                üìö Noun Forms
                            </button>
                            <button class="btn" onclick="startQuizWithType('mixed')" data-type="mixed">
                                üéØ Mixed
                            </button>
                        </div>
                        <div>
                            <button class="btn btn-warning" onclick="startQuiz(true)">Focus on Unlearned</button>
                        </div>
                    </div>
                    
                    <div id="quizContainer" class="quiz-container">
                        <button class="back-button" onclick="showQuizSetup()" id="quizBackBtn">‚Üê Back to Quiz Setup</button>
                        <div id="quizQuestion" class="quiz-question"></div>
                        <div id="quizOptions" class="quiz-options"></div>
                        <div id="quizFeedback"></div>
                        <div id="hintBox" class="hint-box hidden"></div>
                        <div class="navigation">
                            <button class="nav-btn nav-btn-secondary" onclick="previousQuestion()" id="prevBtn">‚Üê Previous</button>
                            <button class="nav-btn nav-btn-primary" onclick="nextQuestion()" id="nextBtn">Next ‚Üí</button>
                            <button class="nav-btn nav-btn-success" onclick="showHint()" id="hintBtn">üí° Hint</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Progress Screen -->
            <div id="progress" class="screen">
                <button class="back-button" onclick="showScreen('mainMenu')">‚Üê Back to Main Menu</button>
                
                <div class="section">
                    <h2>üìä Progress Statistics</h2>
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-number" id="totalWords">0</div>
                            <div class="stat-label">Total Words</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="learnedWords">0</div>
                            <div class="stat-label">Learned</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="accuracy">0%</div>
                            <div class="stat-label">Accuracy</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="currentStreak">0</div>
                            <div class="stat-label">Current Streak</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="bestStreak">0</div>
                            <div class="stat-label">Best Streak</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalQuestions">0</div>
                            <div class="stat-label">Questions</div>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <button class="btn" onclick="resetProgress()">Reset Progress</button>
                    <button class="btn" onclick="exportData()">Export Data</button>
                </div>
            </div>
            
            <!-- Settings Screen -->
            <div id="settings" class="screen">
                <button class="back-button" onclick="showScreen('mainMenu')">‚Üê Back to Main Menu</button>
                
                <div class="section">
                    <h2>‚öôÔ∏è Settings</h2>
                    <div>
                        <h3>Data Management</h3>
                        <button class="btn" onclick="loadSampleData()">Load Sample Data</button>
                        <button class="btn" onclick="exportData()">Export Data</button>
                        <button class="btn btn-danger" onclick="resetProgress()">Reset All Data</button>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h3>About</h3>
                        <p>Latin Study Bot v2.1</p>
                        <p>Features comprehensive vocabulary from chapters 1-7 with grammar testing, progress tracking, and multiple quiz types.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Screen navigation
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            document.getElementById(screenId).classList.add('active');
            
            // Update data if needed
            if (screenId === 'progress') {
                updateStats();
            } else if (screenId === 'vocabulary') {
                updateVocabularyList();
            }
        }
        
        // User management
        let currentUser = null;
        let vocabulary = [];
        let currentQuiz = null;
        let currentQuizType = 'vocabulary';
        let quizStats = {
            totalQuestions: 0,
            correctAnswers: 0,
            currentStreak: 0,
            bestStreak: 0,
            vocabularyCorrect: 0,
            grammarCorrect: 0,
            translationCorrect: 0
        };

        // Comprehensive sample data with grammar information (135+ words from chapters 1-6)
        const sampleData = [
            // Chapter 1 - First Declension & Present Tense
            { latin: "agricola", english: "farmer", part_of_speech: "noun", declension: "1st", gender: "masculine", hint: "First declension masculine noun ending in -a" },
            { latin: "amica", english: "friend (female)", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "amicus", english: "friend (male)", part_of_speech: "noun", declension: "2nd", gender: "masculine", hint: "Second declension masculine noun" },
            { latin: "fama", english: "fame, reputation", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "femina", english: "woman", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "filia", english: "daughter", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "filius", english: "son", part_of_speech: "noun", declension: "2nd", gender: "masculine", hint: "Second declension masculine noun" },
            { latin: "fortuna", english: "fortune, luck", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "insula", english: "island", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "littera", english: "letter (of alphabet)", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "nauta", english: "sailor", part_of_speech: "noun", declension: "1st", gender: "masculine", hint: "First declension masculine noun" },
            { latin: "patria", english: "fatherland, country", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "pecunia", english: "money", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "puella", english: "girl", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "poeta", english: "poet", part_of_speech: "noun", declension: "1st", gender: "masculine", hint: "First declension masculine noun" },
            { latin: "regina", english: "queen", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "silva", english: "forest", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "terra", english: "land, earth", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "via", english: "road, way", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "vita", english: "life", part_of_speech: "noun", declension: "1st", gender: "feminine", hint: "First declension feminine noun" },
            { latin: "amo", english: "to love, like", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "do", english: "to give", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "laudo", english: "to praise", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "navigo", english: "to sail", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "paro", english: "to prepare, get ready", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "porto", english: "to carry", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "pugno", english: "to fight", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "voco", english: "to call", part_of_speech: "verb", conjugation: "1st", tense: "present", voice: "active", hint: "First conjugation present active" },
            { latin: "bonus", english: "good", part_of_speech: "adjective", declension: "1st/2nd", hint: "First/second declension adjective" },
            { latin: "magnus", english: "large, great", part_of_speech: "adjective", declension: "1st/2nd", hint: "First/second declension adjective" },
            { latin: "malus", english: "bad, evil", part_of_speech: "adjective", declension: "1st/2nd", hint: "First/second declension adjective" },
            { latin: "multus", english: "much, many", part_of_speech: "adjective", declension: "1st/2nd", hint: "First/second declension adjective" },
            { latin: "parvus", english: "small, little", part_of_speech: "adjective", declension: "1st/2nd", hint: "First/second declension adjective" },
            
            // Add more sample data as needed...
            { latin: "sum", english: "to be", part_of_speech: "verb", conjugation: "irregular", tense: "present", voice: "active", hint: "Irregular verb - to be" },
            { latin: "possum", english: "to be able, can", part_of_speech: "verb", conjugation: "irregular", tense: "present", voice: "active", hint: "Irregular verb - to be able" },
            { latin: "et", english: "and", part_of_speech: "conjunction", hint: "Coordinating conjunction" },
            { latin: "sed", english: "but", part_of_speech: "conjunction", hint: "Coordinating conjunction" },
            { latin: "nunc", english: "now", part_of_speech: "adverb", hint: "Temporal adverb" },
            { latin: "semper", english: "always", part_of_speech: "adverb", hint: "Temporal adverb" }
        ];

        // Initialize the app
        function init() {
            updateVocabularyList();
            updateStats();
        }

        // Add vocabulary word with grammar information
        function addVocabulary() {
            const latin = document.getElementById('latinInput').value.trim().toLowerCase();
            const english = document.getElementById('englishInput').value.trim();
            const hint = document.getElementById('hintInput').value.trim();
            
            if (!latin || !english) {
                showMessage('Please enter both Latin word and English meaning', 'error');
                return;
            }
            
            // Check if word already exists
            if (vocabulary.find(v => v.latin === latin)) {
                showMessage('This Latin word already exists!', 'error');
                return;
            }
            
            vocabulary.push({
                latin: latin,
                english: english,
                part_of_speech: 'verb', // Default, can be changed
                hint: hint,
                learned: false,
                correct: 0,
                incorrect: 0
            });
            
            saveData();
            updateVocabularyList();
            updateStats();
            
            document.getElementById('latinInput').value = '';
            document.getElementById('englishInput').value = '';
            document.getElementById('hintInput').value = '';
            showMessage('Word added successfully!', 'success');
        }

        // Load sample data
        function loadSampleData() {
            vocabulary = [...comprehensiveFormsData];
            saveData();
            updateVocabularyList();
            updateStats();
            showMessage('Comprehensive forms data loaded!', 'success');
        }

        // Start quiz with specific type
        function startQuizWithType(type) {
            currentQuizType = type;
            startQuiz();
        }
        
        // Show quiz setup
        function showQuizSetup() {
            document.getElementById('quizSetup').style.display = 'block';
            document.getElementById('quizContainer').style.display = 'none';
            currentQuiz = null;
        }
        
        // Select quiz type
        function selectQuizType(type) {
            currentQuizType = type;
            document.querySelectorAll('.quiz-type-selector .btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
        }

        // Start quiz
        function startQuiz(focusUnlearned = false) {
            if (vocabulary.length === 0) {
                showMessage('Please add some vocabulary first!', 'error');
                return;
            }
            
            const availableWords = focusUnlearned ? 
                vocabulary.filter(w => !w.learned) : vocabulary;
            
            if (availableWords.length === 0) {
                showMessage('No unlearned words available!', 'info');
                return;
            }
            
            currentQuiz = {
                words: availableWords,
                currentIndex: 0,
                score: 0,
                total: Math.min(10, availableWords.length),
                type: currentQuizType
            };
            
            document.getElementById('quizSetup').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            
            showQuestion();
        }

        // Show quiz question
        function showQuestion() {
            const word = currentQuiz.words[currentQuiz.currentIndex];
            let question, options, correctAnswer;
            
            if (currentQuiz.type === 'vocabulary' || currentQuiz.type === 'mixed') {
                question = `What does "${word.latin}" mean?`;
                options = generateOptions(word);
                correctAnswer = word.english;
            } else if (currentQuiz.type === 'grammar') {
                question = `What part of speech is "${word.latin}"?`;
                options = generateGrammarOptions(word);
                correctAnswer = word.part_of_speech;
            } else if (currentQuiz.type === 'verb_forms') {
                if (word.part_of_speech === 'verb') {
                    question = `What is the conjugation of "${word.latin}"?`;
                    options = generateVerbOptions(word);
                    correctAnswer = word.conjugation;
                } else {
                    question = `What does "${word.latin}" mean?`;
                    options = generateOptions(word);
                    correctAnswer = word.english;
                }
            } else if (currentQuiz.type === 'noun_forms') {
                if (word.part_of_speech === 'noun') {
                    question = `What is the gender of "${word.latin}"?`;
                    options = generateNounOptions(word);
                    correctAnswer = word.gender;
                } else {
                    question = `What does "${word.latin}" mean?`;
                    options = generateOptions(word);
                    correctAnswer = word.english;
                }
            }
            
            document.getElementById('quizQuestion').textContent = question;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectOption(index, option, correctAnswer);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('nextBtn').classList.add('hidden');
            document.getElementById('hintBox').classList.add('hidden');
        }

        // Generate quiz options
        function generateOptions(correctWord) {
            const options = [correctWord.english];
            const otherWords = vocabulary.filter(w => w.latin !== correctWord.latin);
            
            for (let i = 0; i < 3 && i < otherWords.length; i++) {
                const randomWord = otherWords[Math.floor(Math.random() * otherWords.length)];
                if (!options.includes(randomWord.english)) {
                    options.push(randomWord.english);
                }
            }
            
            return options.sort(() => Math.random() - 0.5);
        }

        // Generate grammar options
        function generateGrammarOptions(word) {
            const partsOfSpeech = ['noun', 'verb', 'adjective', 'pronoun', 'conjunction', 'adverb'];
            const options = [word.part_of_speech];
            const wrongOptions = partsOfSpeech.filter(pos => pos !== word.part_of_speech);
            
            for (let i = 0; i < 3 && i < wrongOptions.length; i++) {
                options.push(wrongOptions[i]);
            }
            
            return options.sort(() => Math.random() - 0.5);
        }

        // Generate verb options
        function generateVerbOptions(word) {
            const conjugations = ['1st', '2nd', '3rd', '4th', 'irregular'];
            const options = [word.conjugation];
            const wrongOptions = conjugations.filter(conj => conj !== word.conjugation);
            
            for (let i = 0; i < 3 && i < wrongOptions.length; i++) {
                options.push(wrongOptions[i]);
            }
            
            return options.sort(() => Math.random() - 0.5);
        }

        // Generate noun options
        function generateNounOptions(word) {
            const genders = ['masculine', 'feminine', 'neuter', 'masculine/feminine'];
            const options = [word.gender];
            const wrongOptions = genders.filter(gender => gender !== word.gender);
            
            for (let i = 0; i < 3 && i < wrongOptions.length; i++) {
                options.push(wrongOptions[i]);
            }
            
            return options.sort(() => Math.random() - 0.5);
        }

        // Select quiz option
        function selectOption(index, selectedAnswer, correctAnswer) {
            const options = document.querySelectorAll('.quiz-option');
            const isCorrect = selectedAnswer === correctAnswer;
            
            // Mark all options
            options.forEach((option, i) => {
                option.onclick = null;
                if (option.textContent === correctAnswer) {
                    option.classList.add('correct');
                } else if (i === index && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            // Update word progress
            const word = currentQuiz.words[currentQuiz.currentIndex];
            if (isCorrect) {
                word.correct++;
                currentQuiz.score++;
                quizStats.correctAnswers++;
                quizStats.currentStreak++;
                quizStats.bestStreak = Math.max(quizStats.bestStreak, quizStats.currentStreak);
                showMessage('Correct! üéâ', 'success');
            } else {
                word.incorrect++;
                quizStats.currentStreak = 0;
                showMessage(`Incorrect. The answer is: ${correctAnswer}`, 'error');
            }
            
            quizStats.totalQuestions++;
            
            // Mark as learned if correct enough times
            if (word.correct >= 3 && word.correct > word.incorrect) {
                word.learned = true;
            }
            
            saveData();
            updateStats();
            
            // Show feedback
            showFeedback(isCorrect, word, correctAnswer);
            
            document.getElementById('nextBtn').classList.remove('hidden');
        }

        // Show feedback
        function showFeedback(isCorrect, word, correctAnswer) {
            const feedbackDiv = document.getElementById('quizFeedback');
            const hintBox = document.getElementById('hintBox');
            
            if (isCorrect) {
                feedbackDiv.innerHTML = `
                    <div class="feedback-box feedback-correct">
                        <h3>‚úÖ Correct!</h3>
                        <p><strong>${word.latin}</strong> = <strong>${correctAnswer}</strong></p>
                        <p>Great job! ${word.hint || 'Keep up the good work!'}</p>
                    </div>
                `;
            } else {
                feedbackDiv.innerHTML = `
                    <div class="feedback-box feedback-incorrect">
                        <h3>‚ùå Incorrect</h3>
                        <p><strong>${word.latin}</strong> = <strong>${correctAnswer}</strong></p>
                        <p>Remember: ${word.hint || 'Study this word more carefully.'}</p>
                    </div>
                `;
            }
            
            if (word.hint) {
                hintBox.innerHTML = `<strong>üí° Hint:</strong> ${word.hint}`;
                hintBox.classList.remove('hidden');
            }
        }

        // Show hint
        function showHint() {
            const word = currentQuiz.words[currentQuiz.currentIndex];
            const hintBox = document.getElementById('hintBox');
            
            if (word.hint) {
                hintBox.innerHTML = `<strong>üí° Hint:</strong> ${word.hint}`;
                hintBox.classList.remove('hidden');
            } else {
                showMessage('No hint available for this word', 'info');
            }
        }

        // Next question
        function nextQuestion() {
            // Clear feedback when moving to next question
            document.getElementById('quizFeedback').innerHTML = '';
            document.getElementById('hintBox').classList.add('hidden');
            
            currentQuiz.currentIndex++;
            
            if (currentQuiz.currentIndex >= currentQuiz.total) {
                // Quiz complete
                const accuracy = Math.round((currentQuiz.score / currentQuiz.total) * 100);
                showMessage(`Quiz Complete! Score: ${currentQuiz.score}/${currentQuiz.total} (${accuracy}%)`, 'success');
                
                document.getElementById('quizSetup').style.display = 'block';
                document.getElementById('quizContainer').style.display = 'none';
                currentQuiz = null;
            } else {
                showQuestion();
            }
        }

        // Previous question
        function previousQuestion() {
            if (currentQuiz.currentIndex > 0) {
                currentQuiz.currentIndex--;
                showQuestion();
            }
        }

        // Update vocabulary list display
        function updateVocabularyList() {
            const container = document.getElementById('vocabularyList');
            container.innerHTML = '';
            
            if (vocabulary.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #7f8c8d;">No vocabulary added yet</p>';
                return;
            }
            
            vocabulary.forEach((word, index) => {
                const item = document.createElement('div');
                item.className = `vocab-item ${word.learned ? 'learned' : ''}`;
                item.innerHTML = `
                    <div>
                        <span class="vocab-latin">${word.latin}</span>
                        <span class="vocab-english">${word.english}</span>
                        ${word.hint ? `<br><small style="color: #7f8c8d;">üí° ${word.hint}</small>` : ''}
                    </div>
                    <div>
                        <span style="color: #7f8c8d; font-size: 0.9em;">
                            ${word.learned ? '‚úì Learned' : '‚óã Not learned'}
                        </span>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        // Update statistics
        function updateStats() {
            const totalWords = vocabulary.length;
            const learnedWords = vocabulary.filter(w => w.learned).length;
            const accuracy = quizStats.totalQuestions > 0 ? 
                Math.round((quizStats.correctAnswers / quizStats.totalQuestions) * 100) : 0;
            
            document.getElementById('totalWords').textContent = totalWords;
            document.getElementById('learnedWords').textContent = learnedWords;
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('currentStreak').textContent = quizStats.currentStreak;
            document.getElementById('bestStreak').textContent = quizStats.bestStreak;
            document.getElementById('totalQuestions').textContent = quizStats.totalQuestions;
            
            // Update progress bar
            const progressFill = document.getElementById('progressFill');
            const progressPercentage = totalWords > 0 ? (learnedWords / totalWords) * 100 : 0;
            progressFill.style.width = progressPercentage + '%';
        }

        // Reset progress
        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress?')) {
                vocabulary.forEach(word => {
                    word.learned = false;
                    word.correct = 0;
                    word.incorrect = 0;
                });
                quizStats = {
                    totalQuestions: 0,
                    correctAnswers: 0,
                    currentStreak: 0,
                    bestStreak: 0,
                    vocabularyCorrect: 0,
                    grammarCorrect: 0,
                    translationCorrect: 0
                };
                saveData();
                updateVocabularyList();
                updateStats();
                showMessage('Progress reset!', 'success');
            }
        }

        // Export data
        function exportData() {
            const data = {
                vocabulary: vocabulary,
                stats: quizStats,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'advanced_latin_vocabulary_export.json';
            a.click();
            URL.revokeObjectURL(url);
            
            showMessage('Data exported!', 'success');
        }

        // Save data to localStorage
        function saveData() {
            if (currentUser) {
                // Don't save data for guest users
                if (currentUser.nickname === 'Guest') {
                    return;
                }
                saveUserData();
            } else {
                localStorage.setItem('advancedLatinVocabulary', JSON.stringify(vocabulary));
                localStorage.setItem('advancedQuizStats', JSON.stringify(quizStats));
            }
        }

        // Show message
        function showMessage(text, type) {
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            
            const container = document.querySelector('.main-content');
            container.insertBefore(message, container.firstChild);
            
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        // User management functions
        function login() {
            const nickname = document.getElementById('nicknameInput').value.trim();
            const pin = document.getElementById('pinInput').value.trim();
            
            if (!validateInputs(nickname, pin)) {
                return;
            }
            
            const userData = loadUserData(nickname, pin);
            if (userData) {
                currentUser = { nickname: nickname, pin: pin };
                vocabulary = userData.vocabulary || [];
                quizStats = userData.quizStats || quizStats;
                showScreen('mainMenu');
                document.getElementById('userNickname').textContent = nickname;
            } else {
                showLoginStatus('Invalid nickname or PIN', 'error');
            }
        }
        
        function register() {
            const nickname = document.getElementById('nicknameInput').value.trim();
            const pin = document.getElementById('pinInput').value.trim();
            
            if (!validateInputs(nickname, pin)) {
                return;
            }
            
            if (userExists(nickname)) {
                showLoginStatus('Nickname already exists', 'error');
                return;
            }
            
            currentUser = { nickname: nickname, pin: pin };
            vocabulary = [];
            quizStats = {
                totalQuestions: 0,
                correctAnswers: 0,
                currentStreak: 0,
                bestStreak: 0,
                vocabularyCorrect: 0,
                grammarCorrect: 0,
                translationCorrect: 0
            };
            // Auto-load sample data for new users
            loadSampleData();
            showScreen('mainMenu');
            document.getElementById('userNickname').textContent = nickname;
        }
        
        function validateInputs(nickname, pin) {
            if (!nickname) {
                showLoginStatus('Please enter a nickname', 'error');
                return false;
            }
            
            if (nickname.length > 16) {
                showLoginStatus('Nickname must be 16 characters or less', 'error');
                return false;
            }
            
            if (!pin) {
                showLoginStatus('Please enter a PIN', 'error');
                return false;
            }
            
            if (!/^\d+$/.test(pin)) {
                showLoginStatus('PIN must contain only numbers', 'error');
                return false;
            }
            
            if (pin.length < 4 || pin.length > 8) {
                showLoginStatus('PIN must be 4-8 numbers', 'error');
                return false;
            }
            
            return true;
        }
        
        function userExists(nickname) {
            return localStorage.getItem(`user_${nickname}`) !== null;
        }
        
        function loadUserData(nickname, pin) {
            try {
                const userData = localStorage.getItem(`user_${nickname}`);
                if (userData) {
                    const data = JSON.parse(userData);
                    if (data.pin === pin) {
                        return data;
                    }
                }
                return null;
            } catch {
                return null;
            }
        }
        
        function saveUserData() {
            // Don't save data for guest users
            if (currentUser && currentUser.nickname === 'Guest') {
                return;
            }
            
            if (currentUser) {
                const data = {
                    nickname: currentUser.nickname,
                    pin: currentUser.pin,
                    vocabulary: vocabulary,
                    quizStats: quizStats
                };
                localStorage.setItem(`user_${currentUser.nickname}`, JSON.stringify(data));
            }
        }
        
        function logout() {
            currentUser = null;
            vocabulary = [];
            quizStats = {
                totalQuestions: 0,
                correctAnswers: 0,
                currentStreak: 0,
                bestStreak: 0,
                vocabularyCorrect: 0,
                grammarCorrect: 0,
                translationCorrect: 0
            };
            showScreen('login');
        }
        
        function loginAsGuest() {
            currentUser = { nickname: 'Guest', pin: '0000' };
            vocabulary = [];
            quizStats = {
                totalQuestions: 0,
                correctAnswers: 0,
                currentStreak: 0,
                bestStreak: 0,
                vocabularyCorrect: 0,
                grammarCorrect: 0,
                translationCorrect: 0
            };
            // Auto-load sample data for guest
            loadSampleData();
            showScreen('mainMenu');
            document.getElementById('userNickname').textContent = 'Guest';
        }
        
        function showLoginStatus(message, type) {
            const statusDiv = document.getElementById('loginStatus');
            statusDiv.textContent = message;
            statusDiv.className = `message ${type}`;
            statusDiv.classList.remove('hidden');
            
            setTimeout(() => {
                statusDiv.classList.add('hidden');
            }, 3000);
        }
        
        // Initialize the app when page loads
        window.onload = init;
    </script>
    <script src="comprehensive_forms_data.js"></script>
</body>
</html>